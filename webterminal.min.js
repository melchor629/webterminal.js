!function(){var Plugin,al,altChars,alt_chars,append,ch,chars,conf,dirHelper,env,getLine,help,line,lines,newLine,parpadeo,pluginName,print,remove,sh,shell,shiftChars,shift_chars,urlHelper,version,_this;chars={q:"U+0051",w:"U+0057",e:"U+0045",r:"U+0052",t:"U+0054",y:"U+0059",u:"U+0055",i:"U+0049",o:"U+004F",p:"U+0050",a:"U+0041",s:"U+0053",d:"U+0044",f:"U+0046",g:"U+0047",h:"U+0048",j:"U+004A",k:"U+004B",l:"U+004C","ñ":"U+00F1","ç":"U+00E7",z:"U+005A",x:"U+0058",c:"U+0043",v:"U+0056",b:"U+0042",n:"U+004E",m:"U+004D"," ":"U+0020",".":"U+002E",",":"U+002C",0:"U+0030",1:"U+0031",2:"U+0032",3:"U+0033",4:"U+0034",5:"U+0035",6:"U+0036",7:"U+0037",8:"U+0038",9:"U+0039","'":"U+0027","¡":"U+00A1","-":"U+002D"},shiftChars={Q:"U+0051",W:"U+0057",E:"U+0045",R:"U+0052",T:"U+0054",Y:"U+0059",U:"U+0055",I:"U+0049",O:"U+004F",P:"U+0050",A:"U+0041",S:"U+0053",D:"U+0044",F:"U+0046",G:"U+0047",H:"U+0048",J:"U+004A",K:"U+004B",L:"U+004C","Ñ":"U+00F1","Ç":"U+00E7",Z:"U+005A",X:"U+0058",C:"U+0043",V:"U+0056",B:"U+0042",N:"U+004E",M:"U+004D"," ":"U+0020",":":"U+003A",";":"U+003B","=":"U+003D","!":"U+0021",'"':"U+0022","·":"U+00B7",$:"U+0024","%":"U+0025","&":"U+0026","/":"U+002F","(":"U+0028",")":"U+0029","?":"U+003F","¿":"U+00BF",_:"U+005F"},altChars={"–":"U+002D","…":"U+002E","„":"U+002C","≠":"U+0030","|":"U+0031","@":"U+0032","#":"U+0033","¢":"U+0034","∞":"U+0035","¬":"U+0036","÷":"U+0037","“":"U+0038","”":"U+0039","´":"U+0027","‚":"U+00A1","[":"Unidentified","]":"U+002B","{":"Unidentified","}":"U+00E7","\\":"U+00BA"},"MacIntel"!==window.navigator.platform&&(shiftChars=$.extend({},shiftChars,{":":"U+00BE",";":"U+00BC","=":"U+0030","!":"U+0031",'"':"U+0032","·":"U+0033",$:"U+0034","%":"U+0035","&":"U+0036","/":"U+0037","(":"U+0038",")":"U+0039","?":"U+00DB","¿":"U+00DD",_:"U+00BD"}),altChars=$.extend({},altChars,{"[":"U+00BA","]":"U+00BB","{":"U+00DE","}":"U+00BF"})),ch={},sh={},al={},$.each(chars,function(i,v){return ch[v]=i}),$.each(shiftChars,function(i,v){return sh[v]=i}),$.each(altChars,function(i,v){return al[v]=i}),chars=ch,shift_chars=sh,alt_chars=al,conf={server:!1,script:"",phpscript:"/"},env={TERM_PROGRAM:window.navigator.userAgent,PWD:decodeURI(document.location.pathname.substr(0,document.location.pathname.lastIndexOf("/")+1)),SHELL:decodeURI(document.location.pathname.substr(0,document.location.pathname.lastIndexOf("/")+1))+"webterminal.js",USER:"guest"},help={},version="v0.2",pluginName="webterminal",_this={},lines=0,line=$(".consola-line")[lines-1],append=function(car){return line=getLine(),$(line).find("span#g").append(car)},print=function(str){return line=getLine(),$(line).find("span#g").append("<br>"+str)},getLine=function(){return lines=$(".consola .consola-line").length,line=$(".consola-line")[lines-1]},remove=function(){var str;return line=getLine(),str=$(line).find("span#g").text().substr(0,$(line).find("span#g").text().length-1),$(line).find("span#g").empty().append(str)},newLine=function(){return lines=$(_this.element).find(".consola-line").length,$(".consola").append('<div class="consola-line"><span id="t"></span><span id="g"></span><span id="l">_</span></div>'),$($(".consola .consola-line")[lines]).find("span#t").text("sh-3.2# "+_this.env.PWD+" "+_this.env.USER+"$ "),$(_this.element).scrollTop(1e5)},urlHelper=function(command){var i,o,url,_i,_len;if(conf=_this.conf,conf.server===!0){if("node.js"===conf.script)url="file:"===document.location.protocol?"http://localhost:8080/":"http://"+document.location.hostname+":8080/",url=url+command+"/"+"?USER="+_this.env.USER;else{if("php"!==conf.script)throw $.webterminal.idioma.scriptError;url="file:"===document.location.protocol?"http://localhost/server.php?c="+command+"&USER="+_this.env.USER:"http://                "+document.location.hostname+conf.phpscript+"server.php?c="+command+"&USER="+_this.env.USER}for(o=0,_i=0,_len=arguments.length;_len>_i;_i++)i=arguments[_i],0!==_i&&(url+="&"+(_i-1)+"="+encodeURI(arguments[_i]),o++);return url+="&PWD="+encodeURI(_this.env.PWD+"&argc="+o)}},dirHelper=function(folder){var carpeta,split;return-1!==folder.indexOf("..")?(split=_this.env.PWD.split("/"),carpeta="",$.each(split,function(i,v){return i<split.length-2?carpeta+=v+"/":void 0}),-1!==folder.indexOf("../")&&(carpeta=folder.replace("../",carpeta))):"."===folder||"./"===folder?(carpeta=_this.env.PWD,-1!==folder.indexOf("./")&&(carpeta=folder.replace("./",carpeta))):carpeta=folder,carpeta},(parpadeo=function(){return 0===$("span#l").length&&$("body").append('<span id="l" style="display:none"></span>'),$("span#l").delay(600).animate({opacity:0},10).delay(600).animate({opacity:1},10,parpadeo)})(),shell={help:function(c){var b;return void 0===c[1]?(print("webterminal, version "+version+" ("+window.navigator.userAgent+")"),print($.webterminal.idioma.shell.help[1]),print($.webterminal.idioma.shell.help[2]),print($.webterminal.idioma.shell.help[3]),$.each(_this.lang.help,function(a,b){return print("&nbsp;"+a+" "+b[0])}),$.each(_this.help,function(a,b){return print("&nbsp;"+a+" "+b[0])})):c[1]&&void 0!==_this.help[c[1]]?(b=_this.help[c[1]],print(c[1]+": "+b[0]),b[1]&&print(b[1])):c[1]&&void 0!==_this.lang.help[c[1]]?(b=_this.lang.help[c[1]],print(c[1]+": "+b[0]),b[1]&&print(b[1])):void 0===_this.help[c[1]]&&void 0===_this.lang.help[c[1]]&&print($.webterminal.idioma.shell.help.noHelp+" `"+c[1]+"`."),newLine()},echo:function(c){var str;return str="",$.each(c,function(a,b){return 0!==a?str+=" "+b:void 0}),print(str),newLine()},env:function(){return $.each(_this.env,function(a,b){return print(a+"="+b)}),newLine()},"export":function(c){var kv;return void 0!==c[1]?(kv=c[1].split("="),_this.env[kv[0]]=kv[1],print(kv[0]+" = "+kv[1])):print("usage: export VARIABLE=VALUE"),newLine()},reload:function(){return $(_this.element).delay(333).animate({opacity:0},1111,function(){return window.location=window.location}),print('Wait…<span id="l">_</span>')},ls:function(){var url;return url=urlHelper("ls",_this.env.PWD),url?$.getJSON(url,function(json){return 0===json.respuesta.res?$.each(json.respuesta.mensaje,function(i,v){return print(v)}):print(json.respuesta.mensaje),newLine()}).error(function(){throw"Server script doesn't exist."}):newLine()},cd:function(c){var carpeta,url;return void 0!==c[1]?(carpeta=dirHelper(c[1]),url=urlHelper("cd",carpeta),url?$.getJSON(url,function(json){return 1===json.respuesta.res?print(json.respuesta.mensaje):_this.env.PWD=json.respuesta.mensaje,newLine()}).error(function(){throw"Server script doesn't exist."}):newLine()):newLine()},rm:function(c){var file,url;return void 0!==c[1]?(file=dirHelper(c[1]),url=urlHelper("rm",file),url?$.getJSON(url,function(json){return 1===json.respuesta.res&&print(json.respuesta.mensaje),newLine()}).error(function(){throw"Server script doesn't exist."}):newLine()):(print("usage: rm file"),newLine())},rmdir:function(c){var file,url;return void 0!==c[1]?(file=dirHelper(c[1]),url=urlHelper("rmdir",file),"-r"===c[2]&&(url+="&recursive"),url?$.getJSON(url,function(json){return 1===json.respuesta.res&&print(json.respuesta.mensaje),newLine()}).error(function(){throw"Server script doesn't exist."}):newLine()):(print("usage: rm directory"),newLine())},touch:function(c){var fileName,url;return void 0!==c[1]?(fileName=dirHelper(c[1]),url=urlHelper("touch",c[1]),url?$.getJSON(url,function(json){return 1===json.respuesta.res&&print(json.respuesta.mensaje),newLine()}).error(function(){throw"Server script doesn't exist."}):newLine()):(print("usage: touch fileName"),newLine())},mkdir:function(c){var fileName,url;return void 0!==c[1]?(fileName=dirHelper(c[1]),url=urlHelper("mkdir",c[1]),url?$.getJSON(url,function(json){return 1===json.respuesta.res&&print(json.respuesta.mensaje),newLine()}).error(function(){throw"Server script doesn't exist."}):newLine()):(print("usage: mkdir directoryName"),newLine())},cwd:function(){return print(_this.env.PWD),newLine()},cat:function(c){var fileName,fileName1,fileName2,url;return void 0!==c[1]&&void 0===c[2]?(fileName=encodeURI(dirHelper(c[1])),url=urlHelper("cat",fileName),url?$.getJSON(url,function(json){return print('<div style="text-align:left;">'+json.respuesta.mensaje+"</div>"),newLine()}).error(function(){throw"Server script doesn't exist."}):newLine()):void 0!==c[1]&&void 0!==c[2]?(fileName1=encodeURI(dirHelper(c[1])),fileName2=encodeURI(dirHelper(c[2])),url=urlHelper("cat",fileName1,fileName2),$.getJSON(url,function(json){return print(json.respuesta.mensaje),newLine()}).error(function(){throw"Server script doesn't exist."})):(print("usage: cat file"),newLine())},login:function(c){var url;return void 0===c[1]?(print("No user/password given"),print("Usage: login USER [PASSWORD]"),newLine()):(url=urlHelper("login",c[1])+"&password="+(void 0!==c[2]?MD5(c[2]):"null"))?$.getJSON(url,function(json){return 1===json.respuesta.res?print(json.respuesta.mensaje):_this.env.USER=json.respuesta.mensaje,newLine()}):void 0},none:function(c){return""!==c[0]?(print("-bash: "+c[0]+": "+$.webterminal.idioma.shell.none),newLine()):void 0}},Plugin=function(element,options){return this.element=element,this.conf=$.extend({},conf,options.conf),this.shell=$.extend({},shell,options.shell),this.env=$.extend({},env,options.env),this.help=$.extend({},help,options.help),this.historial=[],this.init()},Plugin.prototype={init:function(){return function(id){var fjs,js;return fjs=document.getElementsByTagName("script")[0],document.getElementById(id)?void 0:(js=document.createElement("script"),js.id=id,js.src="lib/md5.min.js",fjs.parentNode.insertBefore(js,fjs))}("md5"),this._showTerm(),this.lang(),this.enLaBusquedaDelTextoPerdido(),this._fill(!0),this.console()},_showTerm:function(){return $(this.element).delay(333).animate({opacity:1},1111)},_hideTerm:function(c){return $(this.element).delay(333).animate({opacity:0},1111,c)},enLaBusquedaDelTextoPerdido:function(){return 0===$(this.element).text().length?$(this.element).append('<div class="consola"></div>').find(".consola").append('<div class="consola-line"><span id="t"></span><span id="g"></span><span id="l">_</span></div>').find("span#t").text("sh-3.2# "+env.PWD+" "+env.USER+"$ "):void 0},lang:function(){var disponible,idioma,isThere;return disponible=["es-es","en-gb","en-us"],idioma=window.navigator.language,isThere=!1,$.each(disponible,function(i,v){return!isThere&&v.match(idioma)?(isThere=!0,idioma=v):void 0}),isThere||(idioma="en-gb"),$.getJSON("lib/lang/"+idioma+".json",function(json){return $.webterminal.idioma=json,Plugin.prototype.lang=json})},console:function(){return _this=this,$(document).keydown(function(e){var comando,keyCode,num;if(keyCode=e.originalEvent.keyIdentifier,lines=$(_this.element).find(".consola-line").length,line=$(".consola-line")[lines-1],!(e.metaKey||e.ctrlKey&&82===keyCode||e.ctrlKey&&84===keyCode)){if(e.preventDefault(),_this._fill(!1),0===$(".consola").length&&$(_this.element).append('<div class="consola"></div>').find("span#l").remove(),0===lines)$(".consola").append('<div class="consola-line"><span id="t"></span><span id="g"></span><span id="l">_</span></div>').find("span#t").text("sh-3.2# "+_this.env.PWD+" "+_this.env.USER+"$ ");else if(e.shiftKey||e.altKey||void 0===chars[keyCode])if("U+0008"===keyCode)remove();else if(e.shiftKey&&!e.altKey&&void 0!==shift_chars[keyCode])append(shift_chars[keyCode]);else if(!e.shiftKey&&e.altKey&&void 0!==alt_chars[keyCode])append(alt_chars[keyCode]);else if("Enter"===keyCode)if($(line).find("span#l").remove(),$(line).append("<br>"),comando=$(line).find("span#g").text().split(" "),_this.historial[_this.historial.length]=$(line).find("span#g").text(),$.each(comando,function(a,b){var i,sustituto,variable,vars,_results;if(-1!==b.search("$")){for(vars=b.split("$").length-1,i=0,_results=[];vars>i;)variable=b.split("$")[1],sustituto=_this.env[variable],comando[a]=sustituto?sustituto:"",_results.push(i++);return _results}}),void 0!==_this.shell[comando[0]]&&void 0!==comando[0])try{_this.shell[comando[0]](comando)}catch(_error){throw e=_error,print('<span style="color:red">&gt;&nbsp;Has ocurred an error. See dev tools console</span>'),newLine(),e}else void 0===_this.shell[comando[0]]&&void 0!==comando[0]&&_this.shell.none(comando);else"Up"===keyCode?void 0===$(line).find("span#g").data("historial")?($(line).find("span#g").empty().data("historial",_this.historial.length-1),comando=_this.historial[_this.historial.length-1],append(comando)):(num=parseInt($(line).find("span#g").data("historial"))-1,comando=_this.historial[num],num<=_this.historial.length&&num>=0&&($(line).find("span#g").empty().data("historial",num),append(comando))):"Down"===keyCode&&(void 0===$(line).find("span#g").data("historial")?($(line).find("span#g").empty().data("historial",_this.historial.length+1),comando=_this.historial[_this.historial.length+1]):(num=parseInt($(line).find("span#g").data("historial"))+1,comando=_this.historial[num],num<=_this.historial.length&&num>=0&&($(line).find("span#g").empty().data("historial",num),append(comando))));else append(chars[keyCode]);return $(_this.element).scrollTop(1e5),$(_this.element).height()<$(".consola").height()?$(".consola-line").addClass("consola-line-short"):void 0}})},_fill:function(first){return first===!0&&($[pluginName].shell=this.shell,$[pluginName].print=print,$[pluginName].help=this.help,$[pluginName].newLine=newLine,$[pluginName].urlHelper=urlHelper,$[pluginName].dirHelper=dirHelper,$[pluginName].conf=this.conf),$[pluginName].env=this.env}},$.fn[pluginName]=function(options){var args;return args=arguments,void 0===options||"object"==typeof options?this.each(function(){return $.data(this,"plugin_"+pluginName)?void 0:$.data(this,"plugin_"+pluginName,new Plugin(this,void 0===options?{}:options))}):void 0},$[pluginName]=function(options){return $(".console").webterminal(options.element,options)},_this=Plugin.prototype,$[pluginName].env=_this.env,$[pluginName].shell=_this.shell,$[pluginName].print=print,$[pluginName].help=_this.help,$[pluginName].conf=_this.conf,$[pluginName].newLine=newLine,$[pluginName].urlHelper=urlHelper,$[pluginName].dirHelper=dirHelper,window.webterminal=Plugin}.call(this);